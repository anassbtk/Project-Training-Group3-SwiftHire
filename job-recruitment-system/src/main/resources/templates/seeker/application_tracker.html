<div th:fragment="trackerContent" class="space-y-6">

    <div class="pb-4 border-b border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800">My Application Tracker</h2>
        <p class="text-gray-500">Here is the current status of all your job applications.</p>
    </div>

    <div th:if="${applications != null and !applications.isEmpty()}" class="space-y-4">

        <div th:each="app : ${applications}" class="content-card flex flex-col md:flex-row items-center p-4 gap-4">

            <div class="flex-shrink-0">
                <a th:href="@{/jobs/{id}(id=${app.job.id})}" class="block">
                    <img th:if="${app.job.postedBy.companyLogoFilename != null}"
                         th:src="@{/employer/logos/download/{filename}(filename=${app.job.postedBy.companyLogoFilename})}"
                         alt="Logo" class="w-16 h-16 object-contain rounded-lg border border-gray-100">
                    <div th:if="${app.job.postedBy.companyLogoFilename == null}" class="w-16 h-16 bg-teal-50 text-teal-600 flex items-center justify-center rounded-lg font-bold text-2xl">
                        <span th:text="${#strings.substring(app.job.postedBy.companyName, 0, 1)}">C</span>
                    </div>
                </a>
            </div>

            <div class="flex-1 text-center md:text-left">

                <a th:href="@{/jobs/{id}(id=${app.job.id})}"
                   class="text-lg font-bold text-gray-800 hover:text-theme-teal hover:underline"
                   th:text="${app.job.title}">
                    Job Title
                </a>

                <p class="text-sm text-gray-600" th:text="${app.job.postedBy.companyName}">
                    Company Name
                </p>
                <p class="text-xs text-gray-400 mt-1">
                    Applied on <span th:text="${#temporals.format(app.appliedAt, 'dd MMM yyyy')}">Date</span>
                </p>
            </div>

            <div class="flex-shrink-0 w-full md:w-auto text-center md:text-right">
                <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full"
                      th:text="${app.status}"
                      th:classappend="
                        ${app.status == 'APPLIED'} ? 'bg-blue-100 text-blue-800' :
                        (${app.status == 'REVIEWED'} ? 'bg-yellow-100 text-yellow-800' :
                        (${app.status == 'ACCEPTED'} ? 'bg-green-100 text-green-800' :
                        (${app.status == 'HIRED'} ? 'bg-purple-100 text-purple-800' :
                        (${app.status == 'REJECTED'} ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'))))">
                    STATUS
                </span>
            </div>

            <div th:fragment="trackerContent" class="space-y-6">

                <div class="flex-shrink-0 flex flex-col md:flex-row gap-2 w-full md:w-auto">
                    <a th:href="@{/jobs/{id}(id=${app.job.id})}"
                       class="btn btn-secondary-themed w-full md:w-auto"
                       style="font-size: 0.9em; padding: 8px 12px; border: 1px solid #ccc; text-align: center;">
                        View Job
                    </a>

                    <a th:if="${app.examQuestions != null and !app.examSubmitted}"
                       th:href="@{/seeker/applications/exam/mock/{appId}(appId=${app.id})}"  class="btn w-full md:w-auto bg-yellow-600 hover:bg-yellow-700 text-white font-semibold"
                       style="font-size: 0.9em; padding: 8px 12px; text-align: center;">
                        <i class="fa-solid fa-pencil-alt mr-1"></i> Take Exam
                    </a>

                    <a th:unless="${app.examQuestions != null and !app.examSubmitted}"
                       href="#"
                       th:data-appid="${app.id}"
                       class="view-dialogue-btn btn btn-primary-themed w-full md:w-auto"
                       style="font-size: 0.9em; padding: 8px 12px; text-align: center;">
                        <i class="fa-solid fa-message mr-1"></i> View Dialogue
                    </a>
                </div>

            </div>
        </div>

    </div>

    <div th:if="${applications == null or applications.isEmpty()}" class="text-center py-16 text-gray-500">
        <i class="fa-solid fa-folder-open text-5xl mb-4 text-gray-300"></i>
        <h3 class="text-xl font-semibold text-gray-700">No Applications Found</h3>
        <p class="mt-2">You haven't applied for any jobs yet. Start your search to see your applications here.</p>
        <a href="#" data-view="jobs" class="nav-link btn btn-primary-themed mt-4 inline-block">
            <i class="fa-solid fa-magnifying-glass mr-2"></i> Find Jobs Now
        </a>
    </div>

</div>